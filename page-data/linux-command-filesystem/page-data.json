{"componentChunkName":"component---src-templates-blog-post-js","path":"/linux-command-filesystem/","result":{"data":{"site":{"siteMetadata":{"title":"NARAZUKE","author":[{"name":"nozzle","summary":"who lives in gummaken.","social":{"github":"nozzlex3"}},{"name":"konnyaku","summary":"who is known as Siege Sukosuko Samurai.","social":{"github":"wabetarou"}}]}},"markdownRemark":{"id":"eae4dd2d-189f-5ad8-aaa8-8cd71e6ee638","excerpt":"fstab と mount の違い mount… コマンド, 一時的に作用, 再起動したらリセット\nfstab… 設定ファイル, 起動時に自動でマウントさせるための記述 厳密には違うかもしれないが、通常使用ならこの理解でいいだろ、みんなごめん\nfstab でマウントしたデバイスは umount…","html":"<h2>fstab と mount の違い</h2>\n<p>mount… コマンド, 一時的に作用, 再起動したらリセット\nfstab… 設定ファイル, 起動時に自動でマウントさせるための記述</p>\n<p>厳密には違うかもしれないが、通常使用ならこの理解でいいだろ、みんなごめん\nfstab でマウントしたデバイスは umount を使ってアンマウントできない\nf オプションで強制的にアンマウントできるらしいが、危険らしい</p>\n<h3>fstab の書き方</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">less</span> /etc/fstab\t\t<span class=\"token comment\">#fstabの設定を見ることができる</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">proc\t\t\t\t/proc\t\tproc\tdefaults\t\t\t0\t0\n/dev/hoge\t\t\t/boot\t\tvfat\tdefaults\t\t\t0\t2\nPARTUUID=hogehoge\t/\t\t\text4\tdefaults,noatime\t0\t1\n# a swapfile is not a swap partition, no line here\n#\tuse dphys-swapfile swap[on|off] for that\nUUID=&quot;hogehoge&quot;\t/mnt/ssd\t\text4\tdefaults\t\t\t0\t1</code></pre></div>\n<h4>1 列目…<strong>デバイス名</strong></h4>\n<p><code class=\"language-text\">proc</code>,<code class=\"language-text\">/dev/hoge</code>,<code class=\"language-text\">UUID=hogehoge</code>,<code class=\"language-text\">PARTUUID=hogehoge</code>\n<strong>デバイス名は後に説明する blkid で調べられる</strong>\n気になる人は ↓ へ GO</p>\n<h4>2 列目…<strong>マウントポイント</strong></h4>\n<p><code class=\"language-text\">/proc</code>,<code class=\"language-text\">/boot</code>,<code class=\"language-text\">/mnt/ssd</code>\nどこにファイルシステムを置くか決められる\n<code class=\"language-text\">/mnt</code>じゃなくて<code class=\"language-text\">/media</code>を使う人もいる</p>\n<h4>3 列目…<strong>ファイルシステム名</strong></h4>\n<p><code class=\"language-text\">proc</code>,<code class=\"language-text\">vfat</code>,<code class=\"language-text\">ext4</code>\nwindows なら NTFD が、linux なら ext4 が主流らしい\nproc は仮想ファイルシステムだし、vfat は virtual FAT らしいしややこしいから深入りしないでおくね</p>\n<h4>4 列目…<strong>オプション</strong></h4>\n<p><code class=\"language-text\">defaults</code>,<code class=\"language-text\">defaults,noatime</code>,<code class=\"language-text\">defaults,nofail</code>\n<code class=\"language-text\">defaults</code>は<code class=\"language-text\">async,auto,dev,nouser,rw,suid,exec,noexec</code>をまとめたものらしい</p>\n<p><code class=\"language-text\">noatime</code>で linux がファイルアクセス時に記録するタイムスタンプ<code class=\"language-text\">atime</code>を無効化できる。膨大なファイルにアクセスするときに使える。普段使いならつけなくていい\n<code class=\"language-text\">nofail</code>でマウントに失敗しても boot する。ただのメディア用だったら基本これつけていいと思う。やらずに USB 抜いて起動すると、emergency モードに入るらしい。</p>\n<p>参考:<a href=\"http://g-network.boo.jp/wiki/2018/03/etcfstab/\" title=\"/etc/fstab | ゆるっとエンジニアブログ\">/etc/fstab | ゆるっとエンジニアブログ</a></p>\n<p>参考:<a href=\"https://qiita.com/nishemon/items/a967b950c4bbca08fd88\" title=\"CentOS7の/etc/fstabのnofailオプション（あるいはsystemd）\">CentOS7 の/etc/fstab の nofail オプション（あるいは systemd）</a></p>\n<h4>5 列目…dump 対象</h4>\n<p><code class=\"language-text\">0</code>,<code class=\"language-text\">1</code>\nバックアップの対象にするなら 1\nしないなら 0\n既存の<code class=\"language-text\">proc</code>とか<code class=\"language-text\">boot</code>でさえバックアップ対象にしてないから 0 でいんじゃね？</p>\n<h4>6 列目…fsck の設定</h4>\n<p><code class=\"language-text\">0</code>,<code class=\"language-text\">1</code>,<code class=\"language-text\">2</code>…\nシステム起動時にファイルシステムの検査と修復をしてくれる fsck の対象にするか設定できる。\n<code class=\"language-text\">0</code>なら対象外\n<code class=\"language-text\">1</code>なら 1 番目に検査,<code class=\"language-text\">2</code>なら 2 番目 <code class=\"language-text\">3</code>なら…と続く\n重くなるから基本 0 で OK</p>\n<h3>mount の使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">mount</span> -t ext4 /dev/sda1 /mnt`</code></pre></div>\n<p>mount -t ファイルシステム デバイス名 マウントポイント</p>\n<p>個々の説明はもうしたしいいよね</p>\n<h2>df blkid</h2>\n<p>df… 現在使用中のファイルシステムについて調べる(マウントしたものを表示)\nblkid… 使用可能なファイルシステムについて調べる(接続したものを表示)</p>\n<h3>df の使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">df</span> -h\t\t<span class=\"token comment\">#hコマンドで単位がGBになって見やすくなる</span>\n<span class=\"token function\">df</span> --total\t<span class=\"token comment\">#totalで空き容量の合計が見れる</span></code></pre></div>\n<h3>blkid の使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> blkid\t<span class=\"token comment\">#現在のファイルシステムを調べて表示、こっちを使おう</span>\nblkid\t\t<span class=\"token comment\">#管理者が行ったキャッシュを参照して表示、状況によって表示がでないことも</span>\nblkid -o list\t<span class=\"token comment\">#見やすいけどPARTUUIDが見えなくなるのが気になるところ</span></code></pre></div>\n<h2>おまけ</h2>\n<h3>アンマウントのコマンド、umount の使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">umount</span> /mnt/hoge</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">umount</span> /sda/hoge</code></pre></div>\n<p>マウントポイントでもデバイス名でもいける\nどっちでもいいってのは便利でもあり、ややこしくもある</p>\n<h3>フォーマットのコマンド、mkfs の使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo mkfs -t ext4 dev/sda/hoge</code></pre></div>\n<p>フォーマットしてファイルシステムを作るコマンド\nこちらはデバイス名のみ、当たり前か</p>\n<h3>パーティションを作る</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">fdisk</span> /dev/sda</code></pre></div>\n<p>sda とか sda1 とかあるじゃん<br>\nsd は USB ストレージ<br>\na は 1 台目のストレージ<br>\n1 は一つめのパーティションを表している</p>","fields":{"slug":"/linux-command-filesystem/"},"frontmatter":{"title":"Linuxのファイルシステムコマンドまとめ","created":"2021-2-9 Tue","updated":"2021-2-10 Wed","description":"fstab, mount, df, blkid の違い","tag":["linux"],"author":["nozzle"],"index":"17"}},"previous":{"fields":{"slug":"/gatsby_image/"},"frontmatter":{"title":"gatsbyのimageについて"}},"next":{"fields":{"slug":"/gatsby-markdown-image-decoration/"},"frontmatter":{"title":"gatsbyの特定のimgにCSSを適用"}}},"pageContext":{"index":17,"id":"eae4dd2d-189f-5ad8-aaa8-8cd71e6ee638","previousPostId":"bdaf2968-599e-5870-a399-0633080b0c8e","nextPostId":"ba945092-0ec3-5e3e-bbfe-136edb5a2513"}},"staticQueryHashes":["3284037645","500847697"]}